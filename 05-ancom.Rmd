# ANCOM - Differential Abundance

As per [Rachel Lappan](https://rachaellappan.github.io/VL-QIIME2-analysis/additional-analyses.html)s and [Jamie Morton](https://forum.qiime2.org/t/ancom-giving-strange-w-values/1002/9)s approach - gonna filter out features which appear in only one sample or have a frequency less than 10.

```{bash}
$ mkdir ancom

# Filter features that only appear in a single sample
$ qiime feature-table filter-features \
--i-table DADA2_denoising_output/table.qza \
--p-min-samples 2 \
--o-filtered-table ancom/table001.qza

# Filter features by reads
$ qiime feature-table filter-features \
--i-table ancom/table001.qza \
--p-min-frequency 10 \
--o-filtered-table ancom/table002.qza


# Collapse table at genus level
$ qiime taxa collapse \
--i-table ancom/table002.qza \
--i-taxonomy taxonomy/classified_rep_seqs.qza \
--p-level 6 \
--o-collapsed-table ancom/feature-table-for-ancom.qza

$ cd ancom

# Add pseudocount
$ qiime composition add-pseudocount \
--i-table feature-table-for-ancom.qza \
--o-composition-table ancom-ready-table.qza

# Run ANCOM
$ qiime composition ancom \
--i-table ancom-ready-table.qza \
--m-metadata-file ../metadata.txt \
--m-metadata-column treatment \
--o-visualization ancom_group_results.qzv \
--verbose \
&> ancom.log
```





