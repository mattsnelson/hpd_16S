<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Taxonomic Analysis | High Protein Diet Microbiome Analysis</title>
  <meta name="description" content="This is the workflow for 16S analysis for the high protein diet study" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Taxonomic Analysis | High Protein Diet Microbiome Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the workflow for 16S analysis for the high protein diet study" />
  <meta name="github-repo" content="mattsnelson/hpd_16S" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Taxonomic Analysis | High Protein Diet Microbiome Analysis" />
  
  <meta name="twitter:description" content="This is the workflow for 16S analysis for the high protein diet study" />
  

<meta name="author" content="Matthew Snelson" />


<meta name="date" content="2020-07-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pre-processing-sequence-reads.html"/>
<link rel="next" href="alpha-and-beta-diversity-analyses.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">High Protein Diet study - Microbiome Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a></li>
<li class="chapter" data-level="2" data-path="setup-and-qc.html"><a href="setup-and-qc.html"><i class="fa fa-check"></i><b>2</b> Setup and QC</a><ul>
<li class="chapter" data-level="2.1" data-path="setup-and-qc.html"><a href="setup-and-qc.html#install-qiime-and-acitvate-conda-environment"><i class="fa fa-check"></i><b>2.1</b> Install QIIME and acitvate conda environment</a></li>
<li class="chapter" data-level="2.2" data-path="setup-and-qc.html"><a href="setup-and-qc.html#quality-check-fastqc"><i class="fa fa-check"></i><b>2.2</b> Quality Check (FastQC)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html"><i class="fa fa-check"></i><b>3</b> Pre-processing Sequence Reads</a><ul>
<li class="chapter" data-level="3.1" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#import-data"><i class="fa fa-check"></i><b>3.1</b> Import data</a></li>
<li class="chapter" data-level="3.2" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#denoise-with-dada2"><i class="fa fa-check"></i><b>3.2</b> Denoise with dada2</a></li>
<li class="chapter" data-level="3.3" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#check-denoising-stats"><i class="fa fa-check"></i><b>3.3</b> Check denoising stats</a></li>
<li class="chapter" data-level="3.4" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#get-featuretable-frequency-and-featuredata-sequences"><i class="fa fa-check"></i><b>3.4</b> Get FeatureTable [frequency] and FeatureData [sequences]</a></li>
<li class="chapter" data-level="3.5" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#train-classifier-for-doing-taxonomy"><i class="fa fa-check"></i><b>3.5</b> Train Classifier (for doing taxonomy)</a></li>
<li class="chapter" data-level="3.6" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#classify-rep-seqs"><i class="fa fa-check"></i><b>3.6</b> Classify rep seqs</a></li>
<li class="chapter" data-level="3.7" data-path="pre-processing-sequence-reads.html"><a href="pre-processing-sequence-reads.html#create-a-phylogenetic-tree"><i class="fa fa-check"></i><b>3.7</b> Create a phylogenetic tree</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="taxonomic-analysis.html"><a href="taxonomic-analysis.html"><i class="fa fa-check"></i><b>4</b> Taxonomic Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="taxonomic-analysis.html"><a href="taxonomic-analysis.html#taxonomic-analysis---taxa-barplots"><i class="fa fa-check"></i><b>4.1</b> Taxonomic analysis - taxa barplots</a></li>
<li class="chapter" data-level="4.2" data-path="taxonomic-analysis.html"><a href="taxonomic-analysis.html#generate-heatmap"><i class="fa fa-check"></i><b>4.2</b> Generate heatmap</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="alpha-and-beta-diversity-analyses.html"><a href="alpha-and-beta-diversity-analyses.html"><i class="fa fa-check"></i><b>5</b> Alpha and Beta Diversity Analyses</a><ul>
<li class="chapter" data-level="5.1" data-path="alpha-and-beta-diversity-analyses.html"><a href="alpha-and-beta-diversity-analyses.html#alpha-rarefaction-curves"><i class="fa fa-check"></i><b>5.1</b> Alpha Rarefaction Curves</a></li>
<li class="chapter" data-level="5.2" data-path="alpha-and-beta-diversity-analyses.html"><a href="alpha-and-beta-diversity-analyses.html#diversity-metrics"><i class="fa fa-check"></i><b>5.2</b> Diversity Metrics</a></li>
<li class="chapter" data-level="5.3" data-path="alpha-and-beta-diversity-analyses.html"><a href="alpha-and-beta-diversity-analyses.html#beta-signficance-metrics"><i class="fa fa-check"></i><b>5.3</b> Beta signficance metrics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="picrust2.html"><a href="picrust2.html"><i class="fa fa-check"></i><b>6</b> Picrust2</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">High Protein Diet Microbiome Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="taxonomic-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Taxonomic Analysis</h1>
<div id="taxonomic-analysis---taxa-barplots" class="section level2">
<h2><span class="header-section-number">4.1</span> Taxonomic analysis - taxa barplots</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" data-line-number="1">$ <span class="ex">qiime</span> taxa barplot \</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">--i-table DADA2_denoising_output/table.qza \</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">--i-taxonomy taxonomy/classified_rep_seqs.qza \</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">--m-metadata-file metadata.txt \</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">--o-visualization taxonomy/taxa_barplots.qzv</a></code></pre></div>
<p>This provides taxonomic barplots which I can then download as SVG (also allows for download as csv, which act as input for LefSe). Downloaded csvs and have placed in fig/taxa_barplots/ folder.</p>
</div>
<div id="generate-heatmap" class="section level2">
<h2><span class="header-section-number">4.2</span> Generate heatmap</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" data-line-number="1">$ <span class="fu">mkdir</span> collapsed-tables</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">$ <span class="fu">mkdir</span> heatmaps</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">$ <span class="ex">qiime</span> taxa collapse \</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">--i-table DADA2_denoising_output/table.qza \</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">--i-taxonomy taxonomy/classified_rep_seqs.qza \</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">--p-level 7 \</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">--o-collapsed-table collapsed-tables/collapsed-table-l7.qza</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">$ <span class="ex">qiime</span> feature-table heatmap \</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">--i-table collapsed-tables/collapsed-table-l7.qza \</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">--m-sample-metadata-file metadata.txt \</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">--m-sample-metadata-column treatment \</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">--o-visualization heatmaps/heatmap-l7.qzv</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co"># output heatmap as png/svg</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">$ <span class="ex">qiime</span> tools export \</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">--input-path heatmap-l7.qzv <span class="dt">\ </span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="ex">--output-path</span> heatmap-l7</a></code></pre></div>
<p>Note: As multiple people have noted on the qiime forums, loading the qzv into qiime2view and then trying to export the heatmap figure doesn’t seem to work (at least I’ve never got it to work). So that’s why I add in that export command at the end.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pre-processing-sequence-reads.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="alpha-and-beta-diversity-analyses.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-taxonomy.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["hpd-microbiome.pdf", "hpd-microbiome.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
